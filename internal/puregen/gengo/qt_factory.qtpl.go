// Code generated by qtc from "qt_factory.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

package gengo

import "fmt"

import "cmp"

import "golang.org/x/exp/slices"

import "github.com/vkcom/tl/internal/tlast"

import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

func (gen *genGo) streamgenerateConstants(qw422016 *qt422016.Writer, commentString, pkgName string) {
	qw422016.N().S(commentString)
	qw422016.N().S(`
package `)
	qw422016.N().S(pkgName)
	qw422016.N().S(`
`)
	var sortedConstructors []*tlast.Combinator
	for _, c := range gen.kernel.TL1() {
		if c.Crc32() == 0 {
			continue
		}
		sortedConstructors = append(sortedConstructors, c)
	}
	slices.SortStableFunc(sortedConstructors, func(a, b *tlast.Combinator) int {
		return cmp.Compare(a.Construct.Name.String(), b.Construct.Name.String())
	})

	var sortedTL2Combinators []tlast.TL2Combinator
	for _, combinator := range gen.kernel.TL2() {
		if combinator.IsFunction || combinator.TypeDecl.Magic != 0 {
			sortedTL2Combinators = append(sortedTL2Combinators, combinator)
		}
	}
	slices.SortStableFunc(sortedTL2Combinators, func(a, b tlast.TL2Combinator) int {
		return cmp.Compare(a.ReferenceName().String(), b.ReferenceName().String())
	})

	qw422016.N().S(`const (
`)
	for _, c := range sortedConstructors {
		if c.Crc32() == 0 {
			continue
		}
		qw422016.N().S(`        `)
		qw422016.N().S(canonicalGoName(c.Construct.Name, ""))
		qw422016.N().S(` = `)
		qw422016.N().S(fmt.Sprintf("%#08x", c.Crc32()))
		qw422016.N().S(` // `)
		qw422016.N().S(c.Construct.Name.String())
		qw422016.N().S(`
`)
	}
	for _, c := range sortedTL2Combinators {
		refName := c.ReferenceName()
		magic := c.FuncDecl.Magic
		if !c.IsFunction {
			magic = c.TypeDecl.Magic
		}
		name := canonicalGoName2(refName, "")

		qw422016.N().S(`        `)
		qw422016.E().S(name)
		qw422016.N().S(` = `)
		qw422016.N().S(fmt.Sprintf("%#08x", magic))
		qw422016.N().S(` // `)
		qw422016.N().S(refName.String())
		qw422016.N().S(`
`)
	}
	qw422016.N().S(`)
`)
}

func (gen *genGo) writegenerateConstants(qq422016 qtio422016.Writer, commentString, pkgName string) {
	qw422016 := qt422016.AcquireWriter(qq422016)
	gen.streamgenerateConstants(qw422016, commentString, pkgName)
	qt422016.ReleaseWriter(qw422016)
}

func (gen *genGo) generateConstants(commentString, pkgName string) string {
	qb422016 := qt422016.AcquireByteBuffer()
	gen.writegenerateConstants(qb422016, commentString, pkgName)
	qs422016 := string(qb422016.B)
	qt422016.ReleaseByteBuffer(qb422016)
	return qs422016
}
